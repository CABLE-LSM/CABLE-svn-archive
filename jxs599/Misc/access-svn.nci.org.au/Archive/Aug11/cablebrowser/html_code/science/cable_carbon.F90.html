<HTML> <BODY BGCOLOR=#ffffcc LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<a name='2'>
<A NAME='CARBON_MODULE'><A href='../../html_code/science/cable_carbon.F90.html#CARBON_MODULE' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='3'>
<font color=#993300>MODULE </font><font color=#cc0000>carbon_module</font> <A href='../../call_to/CARBON_MODULE.html' TARGET='index'>1</A><a name='4'>
  USE <A href='../../html_code/common/cable_define_types.F90.html#DEFINE_TYPES'>define_types</A><A href='../../html_code/science/cable_carbon.F90.html#cable_carbon.F90' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFINE_TYPES_11"><a name='5'>
  USE <A href='../../html_code/common/cable_define_dimensions.F90.html#DEFINE_DIMENSIONS'>define_dimensions</A><A href='../../html_code/science/cable_carbon.F90.html#cable_carbon.F90' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFINE_DIMENSIONS_24">, ONLY: r_1,i_d,mp,ms,mvtype,mstype<a name='6'>
  IMPLICIT NONE<a name='7'>
  PRIVATE<a name='8'>
  PUBLIC carbon_pl, soilcarb, plantcarb<a name='9'>
CONTAINS<a name='10'>
<a name='11'>
<A NAME='CARBON_PL'><A href='../../html_code/science/cable_carbon.F90.html#CARBON_PL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>carbon_pl</font>(dels, soil, ssoil, veg, canopy, bgc) <A href='../../call_to/CARBON_PL.html' TARGET='index'>1</A>,<A href='../../call_from/CARBON_PL.html' TARGET='index'>3</A><a name='13'>
      use <A href='../../html_code/common/cable_common.F90.html#CABLE_COMMON_MODULE'>cable_common_module</A><A href='../../html_code/science/cable_carbon.F90.html#CARBON_PL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CABLE_COMMON_MODULE_11">, only : cable_runtime, cable_user<a name='14'>
      use <A href='../../html_code/common/cable_diag.F90.html#CABLE_DIAG_MODULE'>cable_diag_module</A><A href='../../html_code/science/cable_carbon.F90.html#CARBON_PL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CABLE_DIAG_MODULE_4">, only : cable_stat<a name='15'>
   implicit none<a name='16'>
    REAL(r_1), INTENT(IN)                 :: dels     <font color=#447700>! integration time step (s)<a name='17'></font>
    TYPE (soil_parameter_type), INTENT(IN):: soil   <font color=#447700>! soil parameters<a name='18'></font>
    TYPE (soil_snow_type), INTENT(IN)     :: ssoil  <font color=#447700>! soil/snow variables<a name='19'></font>
    TYPE (veg_parameter_type), INTENT(IN) :: veg    <font color=#447700>! vegetation parameters<a name='20'></font>
    TYPE (canopy_type), INTENT(IN)        :: canopy <font color=#447700>! canopy/veg variables<a name='21'></font>
    TYPE (bgc_pool_type), INTENT(INOUT)   :: bgc    <font color=#447700>! biogeochemistry variables<a name='22'></font>
<font color=#447700>!    INTEGER(i_d), INTENT(IN)              :: mvtype  ! Number of vegetation types<a name='23'></font>
    REAL(r_1), PARAMETER     :: beta = 0.9<a name='24'>
    REAL(r_1), DIMENSION(mp) :: cfsf     <font color=#447700>! fast soil carbon turnover<a name='25'></font>
    REAL(r_1), DIMENSION(mp) :: cfrts    <font color=#447700>! roots turnover<a name='26'></font>
    REAL(r_1), DIMENSION(mp) :: cfwd     <font color=#447700>! wood turnover<a name='27'></font>
    REAL(r_1), DIMENSION(mp) :: fcl <font color=#447700>! fraction of assimilated carbon that<a name='28'></font>
                                <font color=#447700>! goes to the construction of leaves  (eq. 5)<a name='29'></font>
    REAL(r_1), DIMENSION(mp) :: fr<a name='30'>
    REAL(r_1), DIMENSION(mp) :: clitt<a name='31'>
    REAL(r_1), DIMENSION(mp) :: coef_cd <font color=#447700>! total stress coeff. for veg (eq. 6)<a name='32'></font>
    REAL(r_1), DIMENSION(mp) :: coef_cold  <font color=#447700>! coeff. for cold stress (eq. 7)<a name='33'></font>
    REAL(r_1), DIMENSION(mp) :: coef_drght <font color=#447700>! coeff. for drought stress (eq. 8)<a name='34'></font>
    REAL(r_1), DIMENSION(:), ALLOCATABLE :: rw, tfcl, tvclst<a name='35'>
<font color=#447700>!jhan:see earliervn for comment<a name='36'></font>
    REAL(r_1), DIMENSION(:), ALLOCATABLE :: trnl, trnr, trnsf, trnw<a name='37'>
<a name='38'>
    REAL(r_1), DIMENSION(mp) :: wbav <font color=#447700>! water stress index <a name='39'></font>
<a name='40'>
      if( cable_user%RUN_DIAG_LEVEL == 'BASIC' ) &amp;    <a name='41'>
         call <A href='../../html_code/common/cable_diag.F90.html#CABLE_STAT'>cable_stat</A><A href='../../html_code/science/cable_carbon.F90.html#CARBON_PL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CABLE_STAT_4">('carbon_pl')<a name='42'>
<a name='43'>
    ALLOCATE( rw(mvtype), tfcl(mvtype), tvclst(mvtype) )<a name='44'>
<a name='45'>
    ALLOCATE( trnl(mvtype), trnr(mvtype), trnsf(mvtype), trnw(mvtype) )<a name='46'>
    trnl = 3.17e-8<a name='47'>
    trnr = 4.53e-9<a name='48'>
    trnsf = 1.057e-10<a name='49'>
    trnw = 6.342e-10<a name='50'>
<a name='51'>
    SELECT CASE (mvtype)<a name='52'>
      CASE (13)     <font color=#447700>! CASA vegetation types<a name='53'></font>
        rw   = (/ 16., 8.7, 12.5, 16., 18., 7.5, &amp;<a name='54'>
                &amp; 6.1, .84, 10.4, 15.1, 9., 5.8, 0.001 /)<a name='55'>
        tfcl = (/ 0.248, 0.345, 0.31, 0.42, 0.38, 0.35, &amp;<a name='56'>
                &amp; 0.997, 0.95, 2.4, 0.73, 2.4, 0.55, 0.9500 /)<a name='57'>
        tvclst = (/ 283., 278., 278., 235., 268., 278.0, &amp;<a name='58'>
                  &amp; 278.0, 278.0, 278.0, 235., 278., 278., 268. /)<a name='59'>
      CASE (15)     <font color=#447700>! CSIRO types for UM<a name='60'></font>
        rw   = (/ 16., 16., 18., 8.7, 10.4, 6.1, 6.1, 6.1, &amp;<a name='61'>
                  5.8, 5.8, 0.001, 9.0, 0.001, 0.001, 0.001 /)<a name='62'>
        tfcl = (/ 0.42, 0.248, 0.38, 0.345, 2.4, 0.997, 0.997, 0.997, &amp;<a name='63'>
                  0.55, 0.55, 0.9500, 2.4, 0.9500, 0.9500, 0.9500 /)<a name='64'>
        tvclst = (/ 235., 283., 268., 278., 278.0, 278.0, 278.0, 278.0, &amp;<a name='65'>
                    278., 278., 278.0, 278., 278., 278., 268. /)<a name='66'>
      CASE (16)     <font color=#447700>! IGBP vegetation types without water bodies<a name='67'></font>
        rw   = (/ 16., 16., 18., 8.7, 12.5, 15.1, 10.4, 7.5, &amp;<a name='68'>
                &amp; 6.1, 6.1, 0.001, 5.8, 0.001, 5.8, 0.001, 9.0 /)<a name='69'>
        tfcl = (/ 0.42, 0.248, 0.38, 0.345, 0.31, 0.73, 2.4, 0.35, &amp;<a name='70'>
                &amp; 0.997, 0.997, 0.9500, 0.55, 0.9500, 0.55, 0.9500, 2.4 /)<a name='71'>
        tvclst = (/ 235., 283., 268., 278., 278., 235., 278.0, 278.0, &amp;<a name='72'>
                  &amp; 278.0, 278.0, 278.0, 278., 278., 278., 268., 278. /)<a name='73'>
      CASE (17)     <font color=#447700>! IGBP vegetation types with water bodies<a name='74'></font>
<font color=#447700>!! rml: may not be the best values for our current 17 types, but will be superceeded by <a name='75'></font>
<font color=#447700>!! CASA-CNP anyway<a name='76'></font>
        rw   = (/ 16., 16., 18., 8.7, 12.5, 15.1, 10.4, 7.5, &amp;<a name='77'>
                &amp; 6.1, 6.1, 0.001, 5.8, 0.001, 5.8, 0.001, 9.0, 0.001 /)<a name='78'>
        tfcl = (/ 0.42, 0.248, 0.38, 0.345, 0.31, 0.73, 2.4, 0.35, 0.997, &amp;<a name='79'>
                &amp; 0.997, 0.9500, 0.55, 0.9500, 0.55, 0.9500, 2.4, 0.9500 /)<a name='80'>
        tvclst = (/ 235., 283., 268., 278., 278., 235., 278.0, 278.0, &amp;<a name='81'>
                  &amp; 278.0, 278.0, 278.0, 278., 278., 278., 268., 278., 278. /)<a name='82'>
      CASE DEFAULT<a name='83'>
        PRINT *, 'Error<font color=#447700>! Dimension not compatible with CASA or CSIRO or IGBP types!'<a name='84'></font>
        PRINT *, 'Dimension =', mvtype<a name='85'>
        PRINT *, 'At the rw section.'<a name='86'>
        STOP<a name='87'>
    END SELECT<a name='88'>
<a name='89'>
      <font color=#447700>! Limit size of exponent to avoif overflow when tv is very cold<a name='90'></font>
      coef_cold = EXP(MIN(1., -(canopy%tv - tvclst(veg%iveg)))) <a name='91'>
      wbav = REAL(SUM(veg%froot * ssoil%wb, 2),r_1)<a name='92'>
      wbav = max(0.01,wbav)  <font color=#447700>! EAK Jan2011<a name='93'></font>
      <font color=#447700>! drought stress<a name='94'></font>
      coef_drght = EXP(5.*( MIN(1., MAX(1.,wbav**(2-soil%ibp2)-1.) / &amp; <a name='95'>
            (soil%swilt**(2-soil%ibp2) - 1.)) - 1.))<a name='96'>
      coef_cd = ( coef_cold + coef_drght ) * 2.0e-7<a name='97'>
      <font color=#447700>!<a name='98'></font>
      <font color=#447700>! CARBON POOLS<a name='99'></font>
      <font color=#447700>!<a name='100'></font>
      fcl = EXP(-tfcl(veg%iveg) * veg%vlai)  <font color=#447700>! fraction of assimilated carbon<a name='101'></font>
                             <font color=#447700>! that goes to the construction of leaves (eq. 5)<a name='102'></font>
      <font color=#447700>!	LEAF<a name='103'></font>
      <font color=#447700>! resp_lfrate is omitted below as fpn represents photosythesis - leaf<a name='104'></font>
      <font color=#447700>! transpiration calculated by the CBM <a name='105'></font>
      <font color=#447700>!<a name='106'></font>
      clitt = (coef_cd + trnl(veg%iveg)) * bgc%cplant(:,1)<a name='107'>
      bgc%cplant(:,1) = bgc%cplant(:,1) - dels * (canopy%fpn * fcl + clitt)<a name='108'>
      <font color=#447700>!<a name='109'></font>
      <font color=#447700>!	WOOD<a name='110'></font>
      <font color=#447700>! fraction of photosynthate going to roots, (1-fr) to wood, eq. 9<a name='111'></font>
      fr = MIN(1., EXP(- rw(veg%iveg) * beta * bgc%cplant(:,3) &amp;<a name='112'>
            &amp; / MAX(bgc%cplant(:,2), 0.01)) / beta)<a name='113'>
      <font color=#447700>!<a name='114'></font>
      <font color=#447700>!                                            <a name='115'></font>
      cfwd = trnw(veg%iveg) * bgc%cplant(:,2)<a name='116'>
      bgc%cplant(:,2) = bgc%cplant(:,2) - dels * (canopy%fpn * (1.-fcl) &amp;<a name='117'>
                    &amp; * (1.-fr) + canopy%frpw + cfwd )<a name='118'>
<a name='119'>
      <font color=#447700>! ROOTS<a name='120'></font>
      <font color=#447700>!				<a name='121'></font>
      cfrts = trnr(veg%iveg) * bgc%cplant(:,3)<a name='122'>
      bgc%cplant(:,3) = bgc%cplant(:,3) - dels * (canopy%fpn * (1. - fcl) * fr &amp;<a name='123'>
                    &amp; + cfrts + canopy%frpr )<a name='124'>
      <font color=#447700>!<a name='125'></font>
      <font color=#447700>! SOIL<a name='126'></font>
      <font color=#447700>!     fast carbon <a name='127'></font>
      cfsf = trnsf(veg%iveg) * bgc%csoil(:,1)<a name='128'>
      bgc%csoil(:,1) = bgc%csoil(:,1) + dels * (0.98 * clitt + 0.9 * cfrts &amp;<a name='129'>
                   &amp; + cfwd - cfsf - 0.98 * canopy%frs)<a name='130'>
      <font color=#447700>!     slow carbon <a name='131'></font>
      bgc%csoil(:,2) = bgc%csoil(:,2) + dels * (0.02 * clitt  + 0.1 * cfrts &amp;<a name='132'>
                   &amp; + cfsf - 0.02 * canopy%frs)<a name='133'>
       <a name='134'>
<font color=#447700>! rml 17/1/11 change minimum pool size from 0.001 to 0. (since want 0. for vegtype=ice)<a name='135'></font>
      bgc%cplant(:,1)  = MAX(0.00, bgc%cplant(:,1))<a name='136'>
      bgc%cplant(:,2)  = MAX(0.00, bgc%cplant(:,2))<a name='137'>
      bgc%cplant(:,3) = MAX(0.00, bgc%cplant(:,3))<a name='138'>
      bgc%csoil(:,1) = MAX(0.00, bgc%csoil(:,1))<a name='139'>
      bgc%csoil(:,2) = MAX(0.00, bgc%csoil(:,2))<a name='140'>
  <a name='141'>
    DEALLOCATE( rw, tfcl, tvclst )<a name='142'>
    DEALLOCATE( trnl, trnr, trnsf, trnw )<a name='143'>
<a name='144'>
  END SUBROUTINE carbon_pl<a name='145'>
<a name='146'>
<A NAME='SOILCARB'><A href='../../html_code/science/cable_carbon.F90.html#SOILCARB' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='147'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>soilcarb</font>( soil, ssoil, veg, bgc, met, canopy) <A href='../../call_to/SOILCARB.html' TARGET='index'>1</A>,<A href='../../call_from/SOILCARB.html' TARGET='index'>2</A><a name='148'>
<a name='149'>
    use <A href='../../html_code/common/cable_physical_constants.F90.html#PHYSICAL_CONSTANTS'>physical_constants</A><A href='../../html_code/science/cable_carbon.F90.html#SOILCARB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PHYSICAL_CONSTANTS_11"><a name='150'>
    use <A href='../../html_code/common/cable_common.F90.html#CABLE_COMMON_MODULE'>cable_common_module</A><A href='../../html_code/science/cable_carbon.F90.html#SOILCARB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CABLE_COMMON_MODULE_12">   <a name='151'>
<a name='152'>
    TYPE (soil_parameter_type), INTENT(IN)   :: soil<a name='153'>
    TYPE (soil_snow_type), INTENT(IN)        :: ssoil<a name='154'>
    TYPE (veg_parameter_type), INTENT(IN)    :: veg<a name='155'>
    TYPE (bgc_pool_type), INTENT(IN)         :: bgc<a name='156'>
    TYPE (met_type), INTENT(IN)              :: met <a name='157'>
    TYPE (canopy_type), INTENT(OUT)          :: canopy<a name='158'>
<a name='159'>
    REAL(r_1), DIMENSION(mp)  :: den <font color=#447700>! sib3  <a name='160'></font>
    INTEGER(i_d)                             :: k<a name='161'>
    REAL(r_1), DIMENSION(mp)  :: rswc   <a name='162'>
    REAL(r_1), DIMENSION(mp)  :: sss    <a name='163'>
    REAL(r_1), DIMENSION(mp)  :: e0rswc <a name='164'>
    REAL(r_1), DIMENSION(mp)  :: ftsoil <a name='165'>
    REAL(r_1), DIMENSION(mp)  :: ftsrs  <a name='166'>
    REAL(r_1), PARAMETER                     :: t0 = -46.0<a name='167'>
    REAL(r_1), DIMENSION(mp)  :: tref   <a name='168'>
    REAL(r_1), DIMENSION(mp)  :: tsoil <a name='169'>
    REAL(r_1), DIMENSION(mstype)             :: rswch<a name='170'>
    REAL(r_1), DIMENSION(mstype)             :: soilcf<a name='171'>
    REAL(r_1), DIMENSION(mp)            :: avgtrs <font color=#447700>!root weighted mean soil temperature<a name='172'></font>
    REAL(r_1), DIMENSION(mp)            :: avgwrs <font color=#447700>!root weighted mean soil moisture<a name='173'></font>
<a name='174'>
    if (cable_user%DIAG_SOIL_RESP == 'off' .OR. &amp;<a name='175'>
         cable_user%DIAG_SOIL_RESP == 'OFF'    )  then<a name='176'>
      avgwrs = sum(veg%froot * ssoil%wb,2)<a name='177'>
      avgtrs = max(0.0,sum(veg%froot * ssoil%tgg,2)-tfrz)<a name='178'>
      canopy%frs = soil%rs20 * min(1.0, max(0.0, min(&amp;<a name='179'>
           -0.0178+0.2883*avgwrs+5.0176*avgwrs*avgwrs-4.5128*avgwrs*avgwrs*avgwrs, &amp;<a name='180'>
           0.3320+22.6726*exp(-5.8184*avgwrs)))) &amp;<a name='181'>
           * min(1.0, max(0.0, min( 0.0104*(avgtrs**1.3053), 5.5956-0.1189*avgtrs)))<a name='182'>
      canopy%frs = canopy%frs &amp;<a name='183'>
           * sum(spread(bgc%ratecs,1,mp) * bgc%csoil,2) &amp;<a name='184'>
           /(365.0*24.0*3600.0)   <font color=#447700>!convert 1/year to 1/second<a name='185'></font>
      WHERE (ssoil%snowd &gt; 1.)<a name='186'>
        canopy%frs = canopy%frs / max(0.001,min(100.,ssoil%snowd))<a name='187'>
      END WHERE<a name='188'>
<a name='189'>
    else<a name='190'>
<a name='191'>
      rswch = 0.16<a name='192'>
      soilcf = 1.0<a name='193'>
<a name='194'>
      den = max(0.07,soil%sfc - soil%swilt)<a name='195'>
      rswc = MAX(0.0001, veg%froot(:,1)*(REAL(ssoil%wb(:,2),r_1) - soil%swilt))&amp;<a name='196'>
         &amp; / den<a name='197'>
      tsoil = veg%froot(:,1) * ssoil%tgg(:,2) - tfrz<a name='198'>
    <a name='199'>
      tref = MAX(0.,ssoil%tgg(:,ms) - (tfrz-.05) )<a name='200'>
    <a name='201'>
      DO k = 2,ms <a name='202'>
         rswc = rswc + MAX(0.0001, veg%froot(:,k) &amp;<a name='203'>
            &amp; * (REAL(ssoil%wb(:,k),r_1) - soil%swilt)) / den<a name='204'>
         tsoil = tsoil + veg%froot(:,k) * ssoil%tgg(:,k)<a name='205'>
      ENDDO<a name='206'>
      rswc = MIN(1.,rswc)<a name='207'>
      tsoil = MAX(t0 + 2., tsoil)<a name='208'>
      e0rswc = 52.4 + 285. * rswc<a name='209'>
      ftsoil=min(0.0015,1./(tref - t0) - 1./(tsoil - t0))<a name='210'>
      sss = MAX(-15.,MIN(1.,e0rswc * ftsoil))<a name='211'>
      ftsrs=EXP(sss)<a name='212'>
      canopy%frs = veg%vegcf * (144.0 / 44.0e6)  &amp;<a name='213'>
         &amp; * soilcf(soil%isoilm) * MIN(1.,1.4 * MAX(.3,.0278 * tsoil + .5)) &amp;<a name='214'>
         &amp; * ftsrs * rswc / (rswch(soil%isoilm) + rswc)<a name='215'>
    endif<a name='216'>
  END SUBROUTINE soilcarb<a name='217'>
<a name='218'>
<font color=#447700>! rml 17/1/11 made plant respiration calculation into a subroutine<a name='219'></font>
<A NAME='PLANTCARB'><A href='../../html_code/science/cable_carbon.F90.html#PLANTCARB' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='220'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>plantcarb</font>(veg, bgc, met, canopy) <A href='../../call_to/PLANTCARB.html' TARGET='index'>1</A>,<A href='../../call_from/PLANTCARB.html' TARGET='index'>1</A><a name='221'>
   use <A href='../../html_code/common/cable_physical_constants.F90.html#PHYSICAL_CONSTANTS'>physical_constants</A><A href='../../html_code/science/cable_carbon.F90.html#PLANTCARB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PHYSICAL_CONSTANTS_12"><a name='222'>
    TYPE (veg_parameter_type), INTENT(IN)    :: veg<a name='223'>
    TYPE (bgc_pool_type), INTENT(IN)         :: bgc<a name='224'>
    TYPE (met_type), INTENT(IN)              :: met<a name='225'>
    TYPE (canopy_type), INTENT(OUT)          :: canopy<a name='226'>
<a name='227'>
    REAL(r_1), DIMENSION(mp) :: poolcoef1 <font color=#447700>! non-leaf carbon turnover rate * non-leaf pool size<a name='228'></font>
    REAL(r_1), DIMENSION(mp) :: poolcoef1w <font color=#447700>! wood carbon turnover rate * wood pool size<a name='229'></font>
    REAL(r_1), DIMENSION(mp) :: poolcoef1r <font color=#447700>! root carbon turnover rate * root pool size<a name='230'></font>
    REAL(r_1), DIMENSION(mp) :: tmp1,tmp2,tmp3<a name='231'>
<a name='232'>
<a name='233'>
    poolcoef1=(sum(spread(bgc%ratecp,1,mp)*bgc%cplant,2) - &amp;<a name='234'>
         bgc%ratecp(1)*bgc%cplant(:,1))<a name='235'>
    poolcoef1w=(sum(spread(bgc%ratecp,1,mp)*bgc%cplant,2) -  &amp;<a name='236'>
         bgc%ratecp(1)*bgc%cplant(:,1) - bgc%ratecp(3)*bgc%cplant(:,3))<a name='237'>
    poolcoef1r=(sum(spread(bgc%ratecp,1,mp)*bgc%cplant,2) -  &amp;<a name='238'>
         bgc%ratecp(1)*bgc%cplant(:,1) - bgc%ratecp(2)*bgc%cplant(:,2))<a name='239'>
<a name='240'>
    tmp1(:) = 3.22 - 0.046 * (met%tk(:)-tfrz)<a name='241'>
    tmp2(:) = 0.1 * (met%tk(:)-tfrz-20.0)<a name='242'>
    tmp3(:) = tmp1(:) ** tmp2(:)<a name='243'>
    canopy%frp  = veg%rp20 * tmp3 * poolcoef1  / (365.0*24.0*3600.0)<a name='244'>
    canopy%frpw = veg%rp20 * tmp3 * poolcoef1w / (365.0*24.0*3600.0)<a name='245'>
    canopy%frpr = veg%rp20 * tmp3 * poolcoef1r / (365.0*24.0*3600.0)<a name='246'>
<a name='247'>
    return<a name='248'>
  END SUBROUTINE plantcarb<a name='249'>
<a name='250'>
<a name='251'>
<a name='252'>
END MODULE carbon_module<a name='253'>
</pre></body></html>