<HTML> <BODY BGCOLOR=#ffffcc LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<a name='2'>
<A NAME='AIR_MODULE'><A href='../../html_code/science/cable_air.F90.html#AIR_MODULE' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='3'>
<font color=#993300>MODULE </font><font color=#cc0000>air_module</font> <A href='../../call_to/AIR_MODULE.html' TARGET='index'>2</A><a name='4'>
  IMPLICIT NONE<a name='5'>
  PRIVATE<a name='6'>
  PUBLIC define_air<a name='7'>
CONTAINS<a name='8'>
  <font color=#447700>!-----------------------------------------------------------------------<a name='9'></font>
<A NAME='DEFINE_AIR'><A href='../../html_code/science/cable_air.F90.html#DEFINE_AIR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='10'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>define_air</font>(met,air) <A href='../../call_to/DEFINE_AIR.html' TARGET='index'>2</A>,<A href='../../call_from/DEFINE_AIR.html' TARGET='index'>6</A><a name='11'>
      USE <A href='../../html_code/common/cable_physical_constants.F90.html#PHYSICAL_CONSTANTS'>physical_constants</A><A href='../../html_code/science/cable_air.F90.html#DEFINE_AIR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PHYSICAL_CONSTANTS_2"><a name='12'>
      use <A href='../../html_code/common/cable_define_types.F90.html#DEFINE_TYPES'>define_types</A><A href='../../html_code/science/cable_air.F90.html#DEFINE_AIR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFINE_TYPES_1">, only : air_type, met_type    <a name='13'>
      use <A href='../../html_code/common/cable_define_dimensions.F90.html#DEFINE_DIMENSIONS'>define_dimensions</A><A href='../../html_code/science/cable_air.F90.html#DEFINE_AIR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEFINE_DIMENSIONS_9">, only : mp, r_1<a name='14'>
      use <A href='../../html_code/common/cable_common.F90.html#CABLE_COMMON_MODULE'>cable_common_module</A><A href='../../html_code/science/cable_air.F90.html#DEFINE_AIR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CABLE_COMMON_MODULE_5">, only : cable_runtime, cable_user, &amp;<a name='15'>
                                       ktau_gl <a name='16'>
      use <A href='../../html_code/common/cable_diag.F90.html#CABLE_DIAG_MODULE'>cable_diag_module</A><A href='../../html_code/science/cable_air.F90.html#DEFINE_AIR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CABLE_DIAG_MODULE_1">, only : cable_stat<a name='17'>
      implicit none<a name='18'>
      TYPE (air_type), INTENT(INOUT) :: air <font color=#447700>! air_type variables<a name='19'></font>
      TYPE (met_type), INTENT(IN)  :: met <font color=#447700>! meteorological variables<a name='20'></font>
    REAL(r_1), DIMENSION(mp)     :: es <font color=#447700>! sat vapour pressure (mb)   <a name='21'></font>
    integer :: i <a name='22'>
      <a name='23'>
      if( cable_user%RUN_DIAG_LEVEL == 'BASIC' ) &amp;    <a name='24'>
        call <A href='../../html_code/common/cable_diag.F90.html#CABLE_STAT'>cable_stat</A><A href='../../html_code/science/cable_air.F90.html#DEFINE_AIR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CABLE_STAT_1">('define_air')<a name='25'>
<a name='26'>
    <font color=#447700>! Calculate saturation vapour pressure<a name='27'></font>
    es = tetena * EXP(tetenb * (met%tvair-tfrz)/(tetenc + (met%tvair-tfrz)))<a name='28'>
    <font color=#447700>! Calculate conversion factor from from m/s to mol/m2/s<a name='29'></font>
<a name='30'>
         <font color=#447700>!do i=1,mp<a name='31'></font>
         <font color=#447700>!print *, 'jhan:air', ktau_gl, i, met%tvair(i) <a name='32'></font>
         <font color=#447700>!enddo<a name='33'></font>
    air%cmolar = met%pmb * 100.0 / (rgas * (met%tvair))<a name='34'>
    <font color=#447700>! Calculate dry air density:<a name='35'></font>
    air%rho = MIN(1.3,rmair * air%cmolar)<a name='36'>
    <font color=#447700>! molar volume (m^3/mol)<a name='37'></font>
    air%volm = rgas * (met%tvair) / (100.0 * met%pmb)<a name='38'>
    <font color=#447700>! latent heat for water (j/kg)<a name='39'></font>
    <font color=#447700>!air%rlam = (2501.0 - 2.38 * (met%tvair- tfrz)) * 1000.0<a name='40'></font>
    air%rlam= hl<a name='41'>
    <font color=#447700>! saturation specific humidity<a name='42'></font>
    air%qsat = (rmh2o / rmair) * es / met%pmb<a name='43'>
    <font color=#447700>! d(qsat)/dT ((kg/kg)/K)<a name='44'></font>
    air%epsi = (air%rlam / capp) * (rmh2o / rmair) * es * tetenb * tetenc / &amp;<a name='45'>
         &amp;  (tetenc + (met%tvair - tfrz)) ** 2 / met%pmb<a name='46'>
    <font color=#447700>! air kinematic viscosity (m^2/s)<a name='47'></font>
    air%visc = 1e-5 * MAX(1.0, 1.35 + 0.0092 * (met%tvair - tfrz))<a name='48'>
    <font color=#447700>! psychrometric constant<a name='49'></font>
    air%psyc = met%pmb * 100.0 * capp * rmair / air%rlam / rmh2o<a name='50'>
    <font color=#447700>! d(es)/dT (mb/K)<a name='51'></font>
    air%dsatdk = 100.0*(tetena*tetenb*tetenc)/((met%tvair-tfrz)+tetenc)**2 &amp;<a name='52'>
         * EXP(tetenb*(met%tvair-tfrz)/((met%tvair-tfrz) + tetenc))<a name='53'>
  END SUBROUTINE define_air<a name='54'>
END MODULE air_module<a name='55'>
</pre></body></html>