# #!/bin/csh -x
#!/bin/csh 
#############################################################################
###  after a bit of book-keeping this csh script will compile CABLE       ###
###  from the "../src" directory and deposit the executable binary in     ###
###  this directory. CABLE is then run over each of the sites specified   ### 
###  in "main.nml" and output data moved into a created directory (out)   ###
###  labelled by the name of the site. finally, an "R" script to produce  ###
###  plots of flux data is called.                                        ### 
#############################################################################

set mypwd = `pwd`
######################################################################
### possibly helpful book-keeping to allow for immediate execution ### 
### and avoid accidently over-writing data - up to a point !!      ###
######################################################################

######################################################################
###  set up directory for this run - make output directory and     ###
### delete old cable binary if it exists.                          ###
######################################################################
if ( -f cable ) then
   rm -f cable
endif

######################################################################
###  manouvre, compile cable, manouvre some more                   ###
######################################################################
pushd ../../build/

if ( -f cable ) then
   rm -f cable
#   make -f Makefiles/Make_CABLE-offline clean
endif

   make -f Makefiles/Make_CABLE-offline cable
   /bin/cp cable $mypwd 
#   make -f Makefiles/Make_CABLE-offline clean
popd
./run_cable
#cat src/CABLE.Rout


