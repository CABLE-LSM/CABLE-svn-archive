#==============================================================================
# This file is part of the 
# Australian Community Atmosphere Biosphere Land Exchange (CABLE) model.
# This work is licensed under the CABLE Academic User Licence Agreement 
# (the "Licence").
# You may not use this file except in compliance with the Licence.
# A copy of the Licence and registration form can be obtained from 
# http://www.cawcr.gov.au/projects/access/cable
# You need to register and read the Licence agreement before use.
# Please contact cable_help@nf.nci.sorg.au for any questions on 
# registration and the Licence.
#
# Unless required by applicable law or agreed to in writing, 
# software distributed under the Licence is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the Licence for the specific language governing permissions and 
# limitations under the Licence.
# ==============================================================================
#
# Purpose: builds CABLE executable for offline case
#
# Contact: Bernard.Pak@csiro.au
#
# History: Additions for CASA-CNP

# Additions for SLI (Vanessa Haverd)
# Additions for SpinCASA (Lars Nieradzik)
# Additions for climate and phenology (Vanessa Haverd)
#
# ==============================================================================
##########################################################################
               
# these are all the files we are compiling
LSRC = cable_data.F90 cable_common.F90 cable_define_types.F90 cable_iovars.F90 \
	cable_abort.F90 casa_variable.F90 cable_parameters.F90 cable_soilsnow.F90 \
	cable_air.F90 cable_albedo.F90 cable_radiation.F90 cable_roughness.F90 \
	cable_carbon.F90 cable_canopy.F90 cable_cbm.F90 cable_checks.F90 \
	cable_read.F90 cable_initialise.F90 cable_input.F90 cable_write.F90 \
	cable_output.F90 casa_cnp.F90 casa_cable.F90 casa_inout.F90 cable_callable_driver.F90 \
	cable_sli_main.F90 cable_sli_numbers.F90 cable_sli_roots.F90 \
	cable_sli_solve.F90 cable_sli_utils.F90  spincasacnp.F90 \
	cable_diag.F90 POP.F90 pop_io.F90 cable_plume_mip.F90 \
	cable_weathergenerator.F90 cable_climate.F90 cable_phenology.F90 \
	cable_cru_TRENDY.F90 POPLUC.F90 CASAONLY_LUC.F90 cable_LUC_EXPT.F90 \
        cable_gw_hydro.F90 cable_namelist_input.F90 cable_psm.F90

ALLOBJS = cable_data.so cable_common.so cable_define_types.so cable_iovars.so cable_abort.so casa_variable.so cable_parameters.so cable_soilsnow.so cable_air.so cable_albedo.so cable_radiation.so cable_roughness.so cable_carbon.so cable_canopy.so cable_cbm.so cable_checks.so cable_read.so cable_initialise.so cable_input.so cable_write.so cable_output.so casa_cnp.so casa_cable.so casa_inout.so cable_callable_driver.so cable_sli_main.so cable_sli_numbers.so cable_sli_roots.so cable_sli_solve.so cable_sli_utils.so  spincasacnp.so cable_diag.so POP.so pop_io.so cable_plume_mip.so cable_weathergenerator.so cable_climate.so cable_phenology.so cable_cru_TRENDY.so POPLUC.so CASAONLY_LUC.so cable_LUC_EXPT.so cable_gw_hydro.so cable_namelist_input.so cable_psm.so
# this is the executable we are building

# from the compiled object files 
OBJS	= ${LSRC:.F90=.so} 

#compiler switches and flags
CINC = -I$(NCMOD)

#suffixes we use
.SUFFIXES:
.SUFFIXES: .F90 .so 
#default rules for these suffixes
.F90.so:
	$(FC) $(CFLAGS)  $<

# default target by convention is ``all''
all: $(ALLOBJS)


# dependencies
#
cable_abort.so: cable_abort.F90 cable_iovars.so cable_define_types.so

cable_data.so: cable_data.F90 
 
cable_diag.so: cable_diag.F90 cable_common.so 
 
cable_air.so: cable_air.F90 cable_define_types.so cable_common.so cable_data.so

cable_albedo.so: cable_albedo.F90 cable_define_types.so cable_common.so cable_data.so

cable_canopy.so: cable_canopy.F90 cable_define_types.so cable_radiation.so cable_roughness.so cable_air.so cable_common.so cable_data.so cable_sli_main.so cable_gw_hydro.so cable_iovars.so cable_psm.so

cable_callable_driver.so: cable_callable_driver.F90 pop_io.so cable_diag.so cable_output.so \
                cable_iovars.so cable_cbm.so casa_variable.so casa_cable.so casa_cnp.so \
                casa_inout.so cable_input.so cable_common.so cable_data.so cable_sli_main.so \
                cable_plume_mip.so cable_climate.so cable_cru_TRENDY.so POPLUC.so cable_LUC_EXPT.so \
                CASAONLY_LUC.so cable_namelist_input.so


cable_carbon.so: cable_carbon.F90 cable_define_types.so cable_common.so cable_data.so

cable_cbm.so: cable_cbm.F90 cable_carbon.so cable_soilsnow.so cable_canopy.so cable_define_types.so cable_roughness.so cable_radiation.so cable_albedo.so casa_variable.so cable_common.so cable_data.so cable_gw_hydro.so

cable_checks.so: cable_checks.F90 cable_radiation.so cable_common.so

cable_define_types.so: cable_define_types.F90

cable_iovars.so: cable_iovars.F90 cable_define_types.so 

cable_read.so: cable_read.F90 cable_iovars.so cable_abort.so 

cable_initialise.so: cable_initialise.F90 cable_read.so cable_iovars.so cable_abort.so  cable_define_types.so

cable_write.so: cable_write.F90 cable_iovars.so cable_abort.so cable_define_types.so 

cable_input.so: cable_input.F90 POP.so cable_checks.so cable_abort.so cable_read.so cable_initialise.so cable_radiation.so \
	       cable_parameters.so cable_common.so cable_LUC_EXPT.so POPLUC.so

cable_output.so: cable_output.F90 cable_abort.so cable_checks.so cable_write.so cable_common.so

cable_parameters.so: cable_parameters.F90 cable_define_types.so cable_iovars.so cable_abort.so casa_variable.so cable_common.so cable_LUC_EXPT.so

cable_radiation.so: cable_radiation.F90 cable_define_types.so cable_common.so cable_data.so 

cable_roughness.so: cable_roughness.F90 cable_define_types.so cable_common.so cable_data.so

cable_soilsnow.so: cable_soilsnow.F90 cable_iovars.so cable_define_types.so cable_common.so cable_data.so

casa_variable.so: casa_variable.F90 POP.so  

spincasacnp.so: spincasacnp.F90  cable_define_types.so  cable_carbon.so cable_common.so casa_variable.so

#cable_LUC.so: cable_LUC.F90 cable_carbon.so cable_common.so casa_variable.so POP.so POPLUC.so cable_LUC_EXPT.so

CASAONLY_LUC.so: CASAONLY_LUC.F90  cable_define_types.so  cable_carbon.so cable_common.so casa_variable.so POP.so POPLUC.so cable_LUC_EXPT.so

casa_cable.so: casa_cable.F90 POP.so cable_define_types.so  cable_carbon.so casa_variable.so \
	      spincasacnp.so cable_diag.so cable_phenology.so casa_cnp.so

casa_cnp.so: casa_cnp.F90 cable_define_types.so  casa_variable.so 

casa_inout.so: casa_inout.F90 POP.so cable_define_types.so  cable_iovars.so casa_variable.so casa_cnp.so

cable_common.so: cable_common.F90  cable_iovars.so

POP.so: POP.F90 cable_define_types.so

POPLUC.so: POPLUC.F90 cable_define_types.so cable_iovars.so casa_variable.so cable_common.so

cable_LUC_EXPT.F90: cable_LUC_EXPT.so cable_define_types.so cable_iovars.so casa_variable.so cable_common.so

pop_io.so: pop_io.F90 POP.so casa_variable.so cable_common.so

cable_sli_main.so: cable_sli_main.F90  cable_define_types.so cable_sli_numbers.so cable_sli_roots.so cable_sli_solve.so cable_soilsnow.so
 
cable_sli_numbers.so: cable_sli_numbers.F90  cable_define_types.so 

cable_sli_roots.so: cable_sli_roots.F90 cable_sli_numbers.so cable_define_types.so

cable_sli_solve.so: cable_sli_solve.F90 cable_sli_numbers.so cable_sli_roots.so cable_sli_utils.so cable_define_types.so

cable_sli_utils.so: cable_sli_utils.F90 cable_sli_numbers.so  cable_define_types.so

cable_plume_mip.so: cable_plume_mip.F90 cable_iovars.so cable_define_types.so cable_checks.so cable_weathergenerator.so

cable_cru_TRENDY.so: cable_cru_TRENDY.F90 cable_iovars.so cable_define_types.so cable_checks.so \
                    cable_weathergenerator.so casa_variable.so

cable_weathergenerator.so: cable_weathergenerator.F90

cable_climate.so: cable_climate.F90 cable_define_types.so cable_iovars.so  cable_common.so

cable_phenology.so: cable_phenology.F90 cable_define_types.so cable_iovars.so  cable_common.so  casa_variable.so

cable_gw_hydro.so: cable_gw_hydro.F90 cable_iovars.so cable_define_types.so cable_common.so cable_data.so cable_soilsnow.so

cable_namelist_input.so: cable_namelist_input.F90

cable_psm.so: cable_psm.F90 cable_define_types.so cable_common.so

#cable_python_driver.so: cable_python_driver.F90 cable_callable_driver.so


#all:    cable_data.so cable_common.so cable_define_types.so cable_iovars.so cable_abort.so casa_variable.so cable_parameters.so cable_soilsnow.so cable_air.so cable_albedo.so cable_radiation.so cable_roughness.so cable_carbon.so cable_canopy.so cable_cbm.so cable_checks.so cable_read.so cable_initialise.so cable_input.so cable_write.so cable_output.so casa_cnp.so casa_cable.so casa_inout.so cable_callable_driver.so cable_sli_main.so cable_sli_numbers.so cable_sli_roots.so cable_sli_solve.so cable_sli_utils.so  spincasacnp.so cable_diag.so POP.so pop_io.so cable_plume_mip.so cable_weathergenerator.so cable_climate.so cable_phenology.so cable_cru_TRENDY.so POPLUC.so CASAONLY_LUC.so cable_LUC_EXPT.so cable_gw_hydro.so cable_namelist_input.so cable_psm.so


# make clean option
clean:
	rm -f *.so *.mod 


#must run  ar r mylib.a $all_files
